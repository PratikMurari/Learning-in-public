<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Load script with Promise</title>
    <script>
      function loadScript(src, { crossOrigin } = {}) {
        return new Promise((resolve, reject) => {
          const script = document.createElement("script");
          script.src = src;
          script.async = true;
          if (crossOrigin) script.crossOrigin = crossOrigin; // e.g., 'anonymous' [2]
          script.onload = () => resolve(src);
          script.onerror = () => reject(new Error("Failed to load: " + src));
          document.head.appendChild(script);
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        loadScript(
          "https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js",
          { crossOrigin: "anonymous" }
        )
          .then(() => {
            alert("Script load complete!");
          })
          .catch((err) => {
            console.error(err);
            alert("Script failed to load. See console for details.");
          });
      });
    </script>
  </head>
  <body>
    <h1>Promise-based script loader demo</h1>
  </body>
</html>
